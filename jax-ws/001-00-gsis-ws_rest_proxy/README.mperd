Adapted from sources downloaded from:
https://bitbucket.org/alexandrosd/wsnprestproxy/

As of 18.I.2013 there is a newer version available at
GSIS site (the code uses version 1).